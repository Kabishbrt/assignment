<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0" />
	<meta http-equiv="Content-Security-Policy" content="style-src 'self' 'unsafe-inline';script-src 'self' 'unsafe-inline' 'unsafe-eval'">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<link rel="stylesheet" href="themes/myTheme.css" />
	<link rel="stylesheet" href="themes/jquery.mobile.icons.min.css"/>
	<link rel="stylesheet" type="text/css" href="./css/style.css">
	<link rel="stylesheet" href="./js/jquery.mobile-1.4.5.css" />
	<script src="./js/jquery.js"></script>
	<script src="./js/jquery.mobile-1.4.5.js"></script>
	<script src="./js/jquery.validate.min.js"></script>
	<script src="./js/jQueryValidation.js"></script>
	<script src="cordova.js"></script>
	<script type="text/javascript" src="js/Calendar.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/jwt-decode@3.1.2/dist/jwt-decode.min.js"></script>
	<script src="./js/index.js"></script>
	<title>Book Swap</title>
</head>

<body>
	<!----------------Login Page--------------------------------->
	<div data-role="page" id="loginPage">
   <!------------------------Header---------------------------->
		<div data-role="header" data-theme="d" data-position="fixed">
			<h1>Book Swap App</h1>
		</div>
		<div id="loadingIndicator" style="display:none; text-align: center; padding: 2px;">
			<!-- Loading spinner or message -->
			<div class="spinner-border" role="status">
				<span class="visually-hidden"><b>...Loading...</b></span>
			</div>
			<!-- You can customize the loading message or spinner as needed -->
		</div>
	<!------------------------Main content---------------------------->
		<div data-role="content">
			<div class="wrap login" style="box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);">
				<div style="box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);">
					<img src="images/logo (2).png" style="width: 100%; height: 100%;" />
				</div>
				<form id="loginForm" method="get" action="" style="padding: 10px;">
					<label>Email</label>
					<div>
						<input id="email" type="email" name="email" placeholder="demo@email.com" />
					</div>
					<br>
					<label>Password</label>
					<div>
						<input id="password" type="password" name="password" placeholder="*******" />
					</div>

					<div style="margin-top:4rem">
						<a href="#" id="loginButton" class="ui-btn ui-shadow ui-corner-all ui-btn-d">Login</a>
					</div>
					<div>
						<a href="#signuppage" rel="external" class="ui-btn ui-shadow ui-corner-all ui-btn-d">Sign up</a>
					</div>
				</form>
			</div>
		</div>	
		<!--footer-->
		<div data-role="footer" data-theme="d" data-position="fixed" class="footer" style="text-align:center;" data-theme="b">
			<p>Copyright © Book Swap Application 2024</p>
		</div>
	</div>

	<!------------------------Register Page------------------------------>
		<div data-role="page" id="signuppage">
			<!------------------------Header---------------------------->
				<div data-role="header" data-theme="d" data-position="fixed">
					<a href="javascript:history.go(-1)" class="ui-btn ui-icon-carat-l ui-btn-icon-notext ui-corner-all">go back</a>
					<h1>Sign Up</h1>
				</div>
		  <!------------------------Main content---------------------------->
				<div data-role="content" id="content">
					<div class="wrap" style="padding: 10px;">
						<p class="fcolor"><b>Register Info</b></p>
						<div id="signingup" style="display:none; text-align: center; padding: 2px;">
							<!-- Loading spinner or message -->
							<div class="spinner-border" role="status">
								<span class="visually-hidden"><b>...SIGNING UP...</b></span>
							</div>
							<!-- You can customize the loading message or spinner as needed -->
						</div>
						<form id="signupform" method="post" action="">
							<!-- Fill info -->
							<input type="text" name="username" placeholder="Username">
							<input type="email" name="email" placeholder="Email">
							<input type="password" name="password" placeholder="Password">
							<input type="text" name="city" placeholder="City">
							<input type="text" name="street" placeholder="Street">
							<button id="signupbutton" type="button" class="ui-btn ui-shadow ui-corner-all ui-btn-d">Submit</button>
							<button id="clearOrderButton" type="reset" class="ui-btn ui-shadow ui-corner-all">Clear</button>
						</form>
					</div>
				</div>
				<!--footer-->
				<div data-role="footer" data-theme="d" data-position="fixed" class="footer" style="text-align:center;">
					<p>Copyright © Book Swap Application 2024</p>
				</div>
			</div>





	<!------------------------Home page---------------------------->
	<div data-role="page" id="homePage">
    <!------------------------Header---------------------------->
		<div data-role="header" data-theme="d" data-position="fixed">
			<a id="logoutLink" href="#loginPage" rel="external" class="ui-btn ui-icon-power ui-btn-icon-notext ui-corner-all"></a>
			<h1>Home Page</h1>
		</div>
    <!------------------------Main content---------------------------->
		<div data-role="content">
			<div class="wrap pb">
				<ul class="ilist" id="menuList">
					<li>
						<a href="#selectPage">
							<img src="images/browsing.png" />
							<div>
								<h3 class = "fcolor">Browse Books</h3>		
							</div>
						</a>
					</li>
					<li>
						<a href="#BookUploadPage">
							<img src="images/book.png" />
							<div>
								<h3 class = "fcolor">Add Books</h3>		
							</div>
						</a>
					</li>
					<li>
						<a href="#myBooksPage">
							<img src="images/bookshelf.png" />
							<div>
								<h3 class = "fcolor">My Books</h3>		
							</div>
						</a>
					</li>
					<li>
						<a href="#UserPage">
							<img src="images/user.png" />
							<div>
								<h3 class = "fcolor">My Profile</h3>		
							</div>
						</a>
					</li>

				</ul>
			</div>
		</div>
		<!--footer-->
		<div data-role="footer" data-theme="d" data-position="fixed" class="footer" style="text-align:center;">
			<p>Copyright © Book Swap Application 2024</p>
		</div>
	</div>

    <!------------------------Select page---------------------------->
		<div data-role="page" id="selectPage">
			<div data-role="header" data-theme="d" data-position="fixed">
		<!------------------------Header---------------------------->
				<a href="javascript:history.go(-1)" class="ui-btn ui-icon-carat-l ui-btn-icon-notext ui-corner-all">go back</a>
				<h1>Available Books</h1>
				<a href="#homePage" class="ui-btn ui-icon-home ui-btn-icon-notext ui-corner-all">home</a>
			</div>
		<!------------------------Main content---------------------------->
		<div data-role="content" id="content"  style="height: auto;">
			<div class="wrap pb">
				<ul class="ilist" id="itemList" style="font-size: 12px;">
					<!-- Books will be dynamically added here -->
				</ul>
			</div>
		</div>
		<!--footer-->
		<div data-role="footer" data-theme="d" data-position="fixed" class="footer" style="text-align:center;">
			<p>Copyright © Book Swap Application 2024</p>
		</div>
	</div>


	
    <!------------------------Fill order page---------------------------->
	<div data-role="page" id="fillOrderPage">
		<div data-role="header" data-theme="d" data-position="fixed">
			<!------------------------Header---------------------------->
					<a href="javascript:history.go(-1)" class="ui-btn ui-icon-carat-l ui-btn-icon-notext ui-corner-all">go back</a>
					<h1>Book Request</h1>
					<a href="#homePage" class="ui-btn ui-icon-home ui-btn-icon-notext ui-corner-all">home</a>
				</div>
	
		<div data-role="main" class="ui-content">
			<p id="email"></p>
			<div id="itemDetails"></div> <!-- List will be displayed here -->
			<label for="description">Description:</label>
			<h3 id="sendingMessage"></h3>
			<textarea id="description" rows="4" placeholder="What book you would like to share and your contact details"></textarea>
			<button id="sendRequest">Send Request</button>
			
            <!-- Loading spinner element -->
		</div>
		<!--footer-->
		<div data-role="footer" data-theme="d" data-position="fixed" class="footer" style="text-align:center;">
			<p>Copyright © Book Swap Application 2024</p>
		</div>
	</div>
     
	<div data-role="page" id="confirmPage">
		<div data-role="header" data-theme="d" data-position="fixed">
			<a href="javascript:history.go(-1)" class="ui-btn ui-btn-icon-left ui-icon-carat-l ui-btn-icon-notext ui-corner-all">go back</a>
			<h1>Order Confirmation</h1>
			<a href="#homePage" class="ui-btn ui-btn-icon-left ui-icon-home ui-btn-icon-notext ui-corner-all">home</a>
		</div>
  	<!------------------------Main content---------------------------->
		<div data-role="content" id="content">
			<div class="wrap">
				<div id = orderConfirmation></div>
				<div style="margin-top:25px">
					<a href="#homePage" rel="external" class="ui-btn ui-shadow ui-corner-all ui-btn-d">Done</a>
				</div>
			</div>
		</div>
		
		<div data-role="footer" data-theme="d" data-position="fixed" class="footer" style="text-align:center;">
			<p>Copyright © Book Swap Application 2024</p>
		</div>
	</div>

	<!------------------------Order list page---------------------------->

	<div data-role="page" id="BookUploadPage">
		<div data-role="header" data-theme="d" data-position="fixed">
			<a href="javascript:history.go(-1)" class="ui-btn ui-btn-icon-left ui-icon-carat-l ui-btn-icon-notext ui-corner-all">go back</a>
			<h1>Upload Your Book</h1>
			<a href="#homePage" class="ui-btn ui-btn-icon-left ui-icon-home ui-btn-icon-notext ui-corner-all">home</a>
		</div>
		<!-- Main content -->
		<div class="wrap" style="padding: 6px;">
			<form id="uploadForm" method="post" action="">
				<input type="text" id="title" name="title" placeholder="Book Title">
				<input type="text" id="author" name="author"  placeholder="Author">
				<input type="text" id="condition" name="condition"  placeholder="Condition">
				<input type="text" id="userid" name="userId"  placeholder="User ID" readonly>
				<input type="file" id="file" name="image" accept="image/*" hidden>
				<div class="img-area" data-img="">
					<i class='bx bxs-cloud-upload icon'></i>
					<h3>Upload Image</h3>
					<p>Image size must be less than <span>2MB</span></p>
				</div>
				<button type="button" class="select-image">Select Image</button>
				<button type="button" id="cameraApp">Camera</button>
				<div>
					<img src="" id="myImage" height="300" width="300">
				</div>
				<input type="button" value="Submit" id="uploadbutton">
			</form>
		</div>
	
		<div data-role="footer" data-theme="d" data-position="fixed" class="footer" style="text-align:center;">
			<p>Copyright © Book Swap Application 2024</p>
		</div>
	
		<!-- JavaScript code for camera functionality -->
		<script>
			// Select relevant elements from the DOM
			const selectImage = document.querySelector('.select-image');
			const inputFile = document.querySelector('#file');
			const imgArea = document.querySelector('.img-area');
			const captureImageBtn = document.querySelector('.capture-image'); // Added
	
			// Event listener for when the "Select Image" button is clicked
			selectImage.addEventListener('click', function () {
				inputFile.click(); // Trigger click event on the hidden file input
			})
	
			// Event listener for when a file is selected
			inputFile.addEventListener('change', function () {
				const image = this.files[0]; // Get the selected image file
				if (image && image.size < 2000000) { // Check if file exists and size is within limit
					const reader = new FileReader(); // Create a FileReader object to read the file
					reader.onload = () => { // Event listener for when file reading is complete
						// Remove any existing images
						const allImg = imgArea.querySelectorAll('img');
						allImg.forEach(item => item.remove());
						// Create a new image element and set its source to the selected image
						const img = document.createElement('img');
						img.src = reader.result;
						// Append the image to the image area and update its dataset
						imgArea.appendChild(img);
						imgArea.classList.add('active');
						imgArea.dataset.img = image.name;
					}
					// Read the selected image file as a data URL
					reader.readAsDataURL(image);
				} else {
					// Display an alert if the file size exceeds the limit
					alert("Image size more than 2MB or no image selected");
				}
			})
			document.getElementById('cameraApp').addEventListener('click', cameraApp);
			function cameraApp() {
				navigator.camera.getPicture (onSuccess, onFail,{
					quality: 100,
					saveToPhotoAlbum:true,
					destinationType: Camera. DestinationType.DATA_URL
				});
				function onSuccess(imageData){
					var image = document.getElementById('myImage');
					image.src = "data:image/jpeg;base64," + imageData;
				}
				function onFail (message) {
					alert('Failed because: + message');
				}
			}
			var userId = localStorage.getItem('userId');

			// Check if userId exists in local storage
			if (userId !== null) {
				// Place the userId into the input field
				document.getElementById('userid').value = userId;
			} else {
				// If userId doesn't exist in local storage, handle accordingly (e.g., show a default value)
				document.getElementById('userid').value = "Default Value";
			}

		</script>
	</div>
	
	<!------------------------User page---------------------------------->
	<div data-role="page" id="UserPage">
		<div data-role="header" data-theme="d" data-position="fixed">
			<a href="javascript:history.go(-1)" class="ui-btn ui-btn-icon-left ui-icon-carat-l ui-btn-icon-notext ui-corner-all">go back</a>
			<h1>User Profile</h1>
			<a href="#homePage" class="ui-btn ui-btn-icon-left ui-icon-home ui-btn-icon-notext ui-corner-all">home</a>
		</div>
  	<!------------------------Main content---------------------------->
		<div data-role="content" id="content">
			<div class="wrap">
				<div id =userdetail style="padding: 10px;"></div>
				<div style="margin-top:25px">
					<a href="#homePage" rel="external" class="ui-btn ui-shadow ui-corner-all ui-btn-d">Done</a>
				</div>
			</div>
		</div>
		
		<div data-role="footer" data-theme="d" data-position="fixed" class="footer" style="text-align:center;">
			<p>Copyright © Book Swap Application 2024</p>
		</div>
	</div>

	

 <!------------------------Select page---------------------------->
 <div data-role="page" id="myBooksPage">
	<div data-role="header" data-theme="d" data-position="fixed">
		<a href="javascript:history.go(-1)" class="ui-btn ui-icon-carat-l ui-btn-icon-notext ui-corner-all">go back</a>
		<h1>My Books</h1>
		<a href="#homePage" class="ui-btn ui-icon-home ui-btn-icon-notext ui-corner-all">home</a>
	</div>
	<div data-role="content" id="content"  style="height: auto;">
		<div class="wrap pb" style="padding: 10px;">
			<table id="mybookTable"  style="border-spacing:10px;">
				<thead>
					<tr>
						<th>Title</th>
						<th>Author</th>
						<th>Condition</th>
						<th>Image</th>
						<th>Delete</th>
					</tr>
				</thead>
				<tbody id="mybookList">
					<!-- Books will be dynamically added here -->
				</tbody>
			</table>
		</div>
	</div>
	<div data-role="footer" data-theme="d" data-position="fixed" class="footer" style="text-align:center;">
		<p>Copyright © Book Swap Application 2024</p>
	</div>
</div>


</body>


</html>